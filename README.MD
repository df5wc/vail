# Vail adapter configuration tool for VBand

## Overview

This repository contains a small tool written in python that allows to configure the great [Vail Adapter](https://github.com/nealey/vail-adapter) for usage with VBand with a sidetone. Without extra configuration the adapter doesn't generate a side tone with a paddle. The tone generated by the VBand web page has latency issues caused by USB and other processing which makes keying harder especially with higher speeds.

How it works: It configures the adapter using midi commands but for keyboard output. As a result, the adapter doesn't only send keystrokes over USB, it does also work as a simple keyer and the adpter internal sidetone generation works. Please note that no changes to the Vail Adapter are necessary. It's just a configuration issue.

See below for usage examples.


## Platform and libraries

This tool was written in python for Linux. It might work for Windows, but I haven't done any tests and have no plans to do so. It requires python 3 and the python `mido` and `rtmidi` packages.


## Options and usage

```
Usage: vail [options]

Available options are:
  -d, --debug                   Enable debug output
  -h, --help                    This text
  -k keyer, --keyer keyer       Set vail keyer (default: iambic b)
  -l, --list                    List available MIDI devices
  -m mode, --mode mode          Set adapter mode (kbd/midi)
  -p port, --port port          MIDI port number to use for configuration
  -t tone, --tone tone          Set TX tone
  -V, --version                 Print version information
  -w wpm, --wpm wpm             Set keyer speed

The --help and --list options will always terminate and will not configure the
adapter. Additional options are ignored in both cases.
It is recommended to use at least the --port option, the programm will use
the first available adapter otherwise which is probably wrong. The port must
be given as a numeric value from the devices list output with --list.
```

With the exception of `--help`, `--list` and `--version` the program will always configure all settings (keyer, tone, wpm). If you don't specify one or the other, you will get default values which are:

| Option  | Range   | Default          | Comment                                                                        |
|---------|---------|------------------|--------------------------------------------------------------------------------|
| --keyer |  1-9    |    8             | See vail adapter documentation for possible values. 7 = iambic a, 8 = iambic b |
| --mode  |         |  kbd             | Use either "kbd" or "midi"                                                     |
| --port  | depends |first midi device | It is suggested to always specify --port                                       |
| --tone  |  0-127  |   69             | See vail adapter documentation for possible values                             |
| --wpm   |  10-50  |   20             |                                                                                |

The parameter for `--port` must be a number from the list output using the `--list` option. So first list the available devices:

```
$ vail --list
 0: Midi Through:Midi Through Port-0 14:0
 1: Seeed XIAO M0:Seeed XIAO M0 MIDI 1 24:0
```

Choose the correct midi device and configure it:

```
$ vail --keyer 8 --mode kbd --port 1 --tone 75 --wpm 20
```

Because of the defaults shown above, this is identical to

```
$ vail --port 1 --tone 75
```

Finally, open the [VBand website](https://hamradio.solutions/vband/) and in the settings configure the input as "straight key". Use the "Practice channel" for some tests. Disable the side tone on the web page by clicking the blue speaker icon for your user on the right. Have fun!
